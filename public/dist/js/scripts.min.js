let dataTableInstance;function fetchProducts(){fetch("/products").then(e=>e.json()).then(e=>{let n=document.getElementById("productsTableBody");n.innerHTML="",dataTableInstance&&dataTableInstance.clear(),e.data.forEach(e=>{var t=[e._id,e.description,e.category,e.price,e.quantity,e.retailer,`<a href="/products/${e._id}/edit" class="btn btn-primary">Edit</a>
                     <button class="btn btn-danger" onclick="deleteProduct('${e._id}')">Delete</button>`];dataTableInstance?dataTableInstance.row.add(t):((t=document.createElement("tr")).innerHTML=`
                        <td>${e._id}</td>
                        <td>${e.description}</td>
                        <td>${e.category}</td>
                        <td>${e.price}</td>
                        <td>${e.quantity}</td>
                        <td>${e.retailer}</td>
                        <td>
                            <a href="/products/${e._id}/edit" class="btn btn-primary">Edit</a>
                            <button class="btn btn-danger" onclick="deleteProduct('${e._id}')">Delete</button>
                        </td>
                    `,n.appendChild(t))}),dataTableInstance?dataTableInstance.draw():dataTableInstance=new DataTable("#productsTable",{paging:!0,searching:!0,ordering:!0,info:!0,pageLength:8})}).catch(e=>console.error("Error loading products:",e))}async function deleteProduct(e){if(confirm("Are you sure you want to delete this product?"))try{(await fetch(`/products/${e}/delete`,{method:"DELETE"})).ok?(alert("Product deleted successfully"),fetchProducts()):alert("Error deleting product")}catch(e){console.error("Error:",e),alert("Error deleting product")}}function fetchOrders(){fetch("/dashboard/orders").then(e=>e.json()).then(e=>{let n=document.getElementById("ordersTableBody");n.innerHTML="",Array.isArray(e)?e.forEach(e=>{var t=document.createElement("tr");t.innerHTML=`
                        <td>${e.totalAmount}</td>
                    `,n.appendChild(t)}):console.error("Expected an array of orders, but got:",e)}).catch(e=>console.error("Error loading orders:",e))}function adminNav(e,t){for(var n,a=document.getElementsByClassName("tabcontent"),d=0;d<a.length;d++)a[d].style.display="none";for(n=document.getElementsByClassName("tablinks"),tablist=document.getElementsByClassName("sidenav-items")[0].getElementsByTagName("li"),d=0;d<n.length;d++)n[d].classList.remove("active");for(d=0;d<tablist.length;d++)tablist[d].classList.remove("active");document.getElementById(t).style.display="block",e.currentTarget.classList.add("active"),e.currentTarget.closest("li").classList.add("active")}window.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("authentication");var t=document.getElementById("register"),n=document.getElementById("login"),a=document.getElementById("logout"),d=document.getElementById("manageProduct"),o=document.getElementById("viewOrder"),r=document.getElementById("forgotPassword"),c=document.getElementById("back-to-sign-in"),s=document.getElementById("footer"),l=document.getElementById("toast__success"),i=document.getElementById("toast_error"),l=(window.addEventListener("load",()=>{setTimeout(()=>{document.querySelector(".loader-content").style.display="none"},2e3)}),null===l&&null===i||(l?M.toast({html:l.getAttribute("data-message"),classes:"toast toast__success",displayLength:4e3}):M.toast({html:i.getAttribute("data-message"),classes:"toast toast__error",displayLength:4e3})),window.location.pathname);"/"!==l&&"/dashboard"!==l||(s.style.display="none"),"/dashboard"===l&&(d.addEventListener("click",fetchProducts),o.addEventListener("click",fetchOrders)),t?.addEventListener("click",()=>{e.classList.add("active")}),n?.addEventListener("click",()=>{e.classList.remove("active")}),a?.addEventListener("click",()=>{fetch("/logout",{method:"POST",credentials:"include"}).then(e=>{e.ok&&(window.location.href="/")}).catch(e=>{console.error("Error logging out:",e)})}),r?.addEventListener("click",e=>{e.preventDefault(),document.getElementById("sign-in-form").style.display="none",document.getElementById("forgot-password-container").style.display="block"}),c?.addEventListener("click",e=>{e.preventDefault(),document.getElementById("sign-in-form").style.display="block",document.getElementById("forgot-password-container").style.display="none"})});