<%- include('./layout/header') %> 
<%- include('./partials/navbar') %>

  <div class="container" id="container">
    <h2>Account</h2>
    <p>Welcome to your account page!</p>

    <div class="profile-card">
      <h2>User Profile</h2>
      <div class="profile-info">
        <div class="info-group">
          <label>Fullname:</label>
          <span id="fullName">
            <%- user.fullName %>
          </span>
        </div>
        <div class="info-group">
          <label>Email:</label>
          <span id="userEmail">
            <%- user.email %>
          </span>
        </div>
      </div>
    </div>

    <div class="order-history">
      <h2>Order History</h2>
      <div id="ordersList">
        <% if (orders && orders.length> 0) { %>
          <% orders.forEach(order=> { %>
            <div class="order-card">
              <div class="order-header">
                <h5>Order #<%- order._id %></h5>
                <span class="order-status <%- order.status %>"><%- order.status %></span>
              </div>
              <div class="order-details">
                <p>Ordered on: <%- new Date(order.orderedAt).toLocaleDateString() %></p>
                <p>Total Amount: $<%- order.totalAmount %></p>
                <div class="order-items">
                  <% order.orderItems.forEach(item=> { %>
                    <div class="order-item">
                      <img src="<%- item.productId.image || 'https://placehold.co/100x100' %>"
                        alt="<%- item.productId.name %>">
                      <div class="item-info">
                        <p><%- item.productId.name %></p>
                        <p>Quantity: <%- item.quantity %></p>
                        <p>Price: $<%- item.price %></p>
                      </div>
                    </div>
                    <% }) %>
                </div>
                <div class="shipping-address">
                  <h6>Shipping Address:</h6>
                  <p><%- order.shippingAddress.street %></p>
                  <p><%- order.shippingAddress.city %>, <%- order.shippingAddress.postalCode %></p>
                  <p><%- order.shippingAddress.country %></p>
                </div>
              </div>
            </div>
            <% }) %>
              <% } else { %>
                <p>No orders found</p>
                <% } %>
      </div>
    </div>
  </div>

  <style>
    .order-card {
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .order-status {
      padding: 5px 10px;
      border-radius: 15px;
      text-transform: capitalize;
    }

    .order-status.pending {
      background-color: #fff3cd;
    }

    .order-status.confirmed {
      background-color: #cce5ff;
    }

    .order-status.delivering {
      background-color: #d4edda;
    }

    .order-status.delivered {
      background-color: #d1e7dd;
    }

    .order-item {
      display: flex;
      align-items: center;
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #eee;
    }

    .order-item img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      margin-right: 10px;
    }

    .shipping-address {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #eee;
    }
  </style>

<%- include('./layout/footer') %>